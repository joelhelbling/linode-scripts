#!/bin/bash

LABEL=linode_initial_setup
CODE_FILE=./stackscripts/$LABEL

PUBLISHED=`linode stackscript source $LABEL`
SOURCE=`cat $CODE_FILE`

DIFF=`diff <(echo "$SOURCE") <(echo "$PUBLISHED")`

if [ -z "$DIFF" ]; then
  echo "Stackscript $LABEL is up to date."
  exit 0
else
  echo "$DIFF"
  exit 1
fi
